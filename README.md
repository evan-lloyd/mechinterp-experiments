# mechinterp-experiments
Code to reproduce various experiments in mechanistic interpretability. Each folder represents a self-contained environment for experimentation; I have opted to duplicate code across experiments rather than trying to maintain a shared library. I recommend opening a single folder as the root project directory in your IDE, since filenames may be shared across experiments which, at least in VSCode, can be confusing. The [uv](https://github.com/astral-sh/uv) package manager is needed for dependency management; once installed, pinned dependencies can be downloaded to each experiment's venv with `uv sync` in the corresponding project directory.

## tiny_stories_sae
Experiments to improve performance of LLM "replacement models" in which each layer's output is transformed by an SAE. The core idea being tested here is adding an extra term to the SAE loss function for the reconstruction of the *next* layer's output, using the SAE already trained for that layer. (For the final layer, this auxiliary loss is the KL divergence between the logits with/without the SAE replacement.)  The hope is that this approximates the performance of [end-to-end](https://arxiv.org/abs/2405.12241) SAEs while being much less computationally expensive, and doing better when more than one layer is replaced. Described in more detail in the [accompanying blog post](https://elloworld.net/posts/replacement-aware-sae-training/).
